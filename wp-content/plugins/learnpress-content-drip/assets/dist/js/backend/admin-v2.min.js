document.addEventListener("DOMContentLoaded",(function(){(()=>{const e=document.querySelector("#lp_contentdrip_course_data input#_lp_content_drip_enable");if(null!==e){let t;e.addEventListener("change",(function(e){e.target.checked&&document.addEventListener("click",(function(e){e.target.classList.contains("editor-post-publish-button")&&(t=setInterval((function(){if(null!==document.querySelector("div.edit-post-meta-boxes-area.is-normal.is-loading")){let e=setInterval((function(){document.querySelector("div.edit-post-meta-boxes-area").classList.contains("is-loading")||(clearInterval(e),clearInterval(t),window.location.reload(!0))}),1e3)}}),1e3))}))}))}const t=document.querySelector("#lp_contentdrip_course_data a.save-post-ctd");null!==t&&t.addEventListener("click",(function(e){let t;e.preventDefault(),t=null!==document.querySelector("#publishing-action input#publish")?document.querySelector("#publishing-action input#publish"):document.querySelector("button.editor-post-publish-button__button"),null!==t&&t.click()}))})();const e=document.querySelector("table.learnpress_page_content-drip-items");if(null===e)return;const t=e.querySelectorAll("tbody#the-list tr");if(0===t.length)return;const n=window.location.search,r=new URLSearchParams(n).get("course-id");((e,t)=>{const n=document.querySelectorAll(".learn-press-update-drip-items");0!==n.length&&n.forEach((function(n){n.addEventListener("click",(function(r){r.preventDefault(),n.classList.add("loading");let o=[];e.forEach((function(e){let t={};const n=e.querySelector("td.title-item-content-drip").dataset.id,r=e.querySelector("select.drip-prerequisite-items"),s=e.querySelector("select.delay-type");if(null!==r){const e=r.options,n=[];for(var i=0,l=r.options.length;i<l;i++)opt=e[i],opt.selected&&n.push(opt.value);t.prerequisite=n}else t.prerequisite=[];null!==s&&(t.type=s.value);const c=e.querySelector("input.delay-specific-datetimepicker");null!==c&&(t.date=c.value);const a=e.querySelector("input.delay-interval-0");null!==a&&(t.interval=a.value);const d=e.querySelector("select.delay-interval-1");null!==d&&(t.interval_type=d.value),o.push({id:n,settings:t})})),(async(e,n)=>{const r=document.getElementById("content-drip-settings-message");try{const r=await wp.apiFetch({path:"lp/content-drip/v1/update-settings",method:"POST",data:{courseID:t,dataSettings:e}});n.classList.remove("loading");const{status:o,message:s}=r;if("error"===o)throw new Error(s||"Error")}catch(e){r.insertAdjacentHTML("beforeend",`<div class="lp-ajax-message error" style="display:block">${e.message||"Error: Query lp/content-drip/v1/update-settings"}</div>`)}})(o,n)}))}))})(t,r),((e,t)=>{const n=document.querySelectorAll(".learn-press-reset-drip-items");0!==n.length&&n.forEach((function(n){n.addEventListener("click",(function(r){r.preventDefault(),n.classList.add("loading");const o=[];e.forEach((function(e){const t=e.querySelector("td.title-item-content-drip").dataset.id;o.push(t)})),(async(e,n)=>{const r=document.getElementById("content-drip-settings-message");try{const r=await wp.apiFetch({path:"lp/content-drip/v1/reset-settings",method:"POST",data:{courseID:t,dataReset:e}});n.classList.remove("loading");const{status:o,message:s}=r;if("error"===o)throw new Error(s||"Error");window.location.reload(!0)}catch(e){r.insertAdjacentHTML("beforeend",`<div class="lp-ajax-message error" style="display:block">${e.message||"Error: Query lp/content-drip/v1/reset-settings"}</div>`)}})(o,n)}))}))})(t,r)}));