!function(){"use strict";var e="https://js.stripe.com/v3",t=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,n="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",r=null,o=Promise.resolve().then((function(){return o=null,null!==r||(r=new Promise((function(r,i){if("undefined"!=typeof window&&"undefined"!=typeof document)if(window.Stripe&&o&&console.warn(n),window.Stripe)r(window.Stripe);else try{var s=function(){for(var n=document.querySelectorAll('script[src^="'.concat(e,'"]')),r=0;r<n.length;r++){var o=n[r];if(t.test(o.src))return o}return null}();s&&o?console.warn(n):s||(s=function(t){var n=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(e).concat(n);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(r),r}(o)),s.addEventListener("load",(function(){window.Stripe?r(window.Stripe):i(new Error("Stripe.js not available"))})),s.addEventListener("error",(function(){i(new Error("Failed to load Stripe.js"))}))}catch(e){return void i(e)}else r(null)}))),r;var o})),i=!1;o.catch((function(e){i||console.warn(e)}));const s=(()=>{let e,t,n,r,s,a,c=!1;const l=e=>{const t=`<div class="learn-press-message error">${e}</div>`;r.insertAdjacentHTML("afterbegin",t),r.scrollIntoView({behavior:"smooth"})};return{init:async()=>{"undefined"==typeof lpStripeSetting&&console.log("LP Stripe Setting is not defined"),void 0!==lpStripeSetting.payment_stripe_via_iframe&&(r=document.getElementById("learn-press-checkout"),t=document.getElementById("learn-press-checkout-form"),t&&await(async()=>{try{e=await function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i=!0;var r=Date.now();return o.then((function(e){return function(e,t,n){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.54.2",startTime:t})}(r,n),r}(e,t,r)}))}(lpStripeSetting.publish_key||"");const t={clientSecret:lpStripeSetting.publishableKey||"",appearance:{}};n=e.elements(t);const r=n.create("payment");r.on("loaderror",(function(e){a=e.error.message})),r.on("ready",(function(e){c=!0})),r.mount("#lp-stripe-payment-form")}catch(e){a=e.message}})())},events:()=>{document.addEventListener("click",(function(o){const i=o.target;if("learn-press-checkout-place-order"===i.id){const d=i;if(t=document.getElementById("learn-press-checkout-form"),!t)return;const u=new FormData(t);if("stripe"!==u.get("payment_method"))return;if(o.preventDefault(),!r)return void console.error("Page checkout is not defined");const p=r.querySelectorAll(".learn-press-message.error");if(p.length>0&&p.forEach((e=>{e.remove()})),void 0!==a)return void l(a);if(void 0===lpStripeSetting.publishableKey)return void l("Stripe Publish Key is generate failed, please check again config key!");if(!c)return void l("Stripe payment not load done. Please wait!");n.submit().then((function(t){void 0===t.error&&(d.classList.add("loading"),d.disabled=!0,d.innerText=lpCheckoutSettings.i18n_processing,s=new URL(lpCheckoutSettings.ajaxurl),s.searchParams.set("lp-ajax","checkout"),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fetch(s,{method:"POST",body:e}).then((e=>e.text())).then((e=>{e=LP.parseJSON(e),t.success(e)})).finally((()=>{t.completed()})).catch((e=>t.error(e)))}(u,{before:()=>{},success:t=>{var r,o;"fail"===t.result?(d.classList.remove("loading"),d.disabled=!1,d.innerText=lpCheckoutSettings.i18n_place_order,l(t.messages)):"processing"===t.result&&(d.innerText=lpCheckoutSettings.i18n_redirecting,r=t.redirect,o=e=>{console.log(e)},void 0===e&&console.log("Stripe is not defined"),void 0===n&&console.log("Stripe form not mounted"),e.confirmPayment({elements:n,confirmParams:{return_url:r}}).then((function(e){o(e)})))},error:e=>{},completed:()=>{}}))}))}}))}}})();document.addEventListener("DOMContentLoaded",(()=>{s.init().then((()=>{}))})),s.events()}();